syst_gluon = {
    100:    {
        'exp':(0.44,0.34),
        'me' :(0.04,0.04),
        'pdf':(0.01,0.01),
        },#50-100 GeV
    200:    {
        'exp':(0.29,0.24),
        'me' :(0.06,0.06),
        'pdf':(0.06,0.05),
        },#100-200 GeV
    300:    {
        'exp':(0.15,0.24),
        'me' :(0.05,0.05),
        'pdf':(0.11,0.10),
        },#200-300 GeV
    400:    {
        'exp':(0.24,0.17),
        'me' :(0.12,0.12),
        'pdf':(0.18,0.19),
        },#300-400 GeV
    500:    {
        'exp':(0.21,0.33),
        'me' :(0.14,0.14),
        'pdf':(0.22,0.27),
        },#400-500 GeV
    600:    {
        'exp':(0.37,0.43),
        'me' :(0.16,0.16),
        'pdf':(0.25,0.34),
        },#500-600 GeV
    800:    {
        'exp':(0.48,0.58),
        'me' :(0.06,0.06),
        'pdf':(0.30,0.48),
        },#600-800 GeV
    1000:    {
        'exp':(1.01,1.03),
        'me' :(0.01,0.01),
        'pdf':(0.30,0.60),
        },#800-1000 GeV
    1200:    {
        'exp':(2.20,2.39),
        'me' :(0.05,0.05),
        'pdf':(0.41,1.01),
        },#1000-1200 GeV
    1500:    {
        'exp':(6.09,6.16),
        'me' :(0.22,0.22),
        'pdf':(0.23,0.81),
        }#200-300 GeV
    }
syst_quark = {
    100:    {
        'exp':(0.82,1.16),
        'me' :(0.06,0.06),
        'pdf':(0.02,0.02),
        },#50-100 GeV
    200:    {
        'exp':(0.36,0.41),
        'me' :(0.23,0.23),
        'pdf':(0.11,0.10),
        },#100-200 GeV
    300:    {
        'exp':(0.26,0.28),
        'me' :(0.19,0.19),
        'pdf':(0.17,0.16),
        },#200-300 GeV
    400:    {
        'exp':(0.22,0.30),
        'me' :(0.23,0.23),
        'pdf':(0.27,0.24),
        },#300-400 GeV
    500:    {
        'exp':(0.25,0.32),
        'me' :(0.22,0.22),
        'pdf':(0.33,0.27),
        },#400-500 GeV
    600:    {
        'exp':(0.30,0.35),
        'me' :(0.25,0.25),
        'pdf':(0.38,0.28),
        },#500-600 GeV
    800:    {
        'exp':(0.32,0.36),
        'me' :(0.26,0.26),
        'pdf':(0.44,0.30),
        },#600-800 GeV
    1000:    {
        'exp':(0.41,0.47),
        'me' :(0.22,0.22),
        'pdf':(0.47,0.28),
        },#800-1000 GeV
    1200:    {
        'exp':(0.69,0.67),
        'me' :(0.23,0.23),
        'pdf':(0.62,0.33),
        },#1000-1200 GeV
    1500:    {
        'exp':(1.42,1.70),
        'me' :(0.16,0.16),
        'pdf':(0.45,0.21),
        }#1200-1500 GeV
    }
    
def getsyst(flav,ptmax,systname):
    if 'quark'==flav:
        return syst_quark[ptmax][systname]
    elif 'gluon'==flav:
        return syst_gluon[ptmax][systname]

import numpy as np
def applysyst(sign,syst,ntracks):
    return ntracks+sign*( int(syst)+(np.random.rand(len(ntracks))<(syst%1)) )
